---
title: "Final Project First Draft"
output: pdf_document
---
\maketitle

#### Running Title:
07 - 405 - Crimes in Chicago

#### Group Members:
Benjamin Mao, Cecilia Xin, Monica Liu, Jared Boyd

#### Introduction to Project and Dataset:
Our goal for this project is to find patterns in crime in Chicago. Our dataset
is sourced from the Chicago Police Department's CLEAR system, comprising 
reported incidents of crime in the City of Chicago from 2001 to the present, 
with addresses anonymized at the block level for victim privacy. This data
includes the date, time, type, and general location of crime in Chicago.

#### Load in the Data
---

```{r}
#library(readr)
#crimes_data <- read_csv("Crimes_-_2001_to_Present.csv")
```

#### Six plots
## Histogram
With this plot we will analyze the number of crimes in different years

```{r}
hist(crimes_data$Year, main = "Distribution of Years", xlab = "Year", 
     ylab = "Frequency", col = "skyblue", border = "white")
```

## Curve
With this plot we will analyze the number of crimes within a year

```{r}
crime_data_2001_to_2023 <- crimes_data[crimes_data$Year %in% 2001:2023, ]
total_crimes_2001_to_2023 <- rep(7996344)
crime_data_2001_to_2023 <- data.frame(Year = 2001:2023, 
                                      Number_of_Crimes = rep(total_crimes_2001_to_2023, 23))
# curve
plot(crime_data_2001_to_2023$Year, crime_data_2001_to_2023$Number_of_Crimes, 
     type = "o",  
     xlab = "Year", ylab = "Number of Crimes",
     main = "Number of Crimes from 2001 to 2023",
     col = "pink", pch = 16) 

```

## Pie Chart
With this plot we will analyze the frequency of the different crime types

```{r}
crime_type <- table(crimes_data$`Primary Type`)
total_crimes <- sum(crime_type)
crime_type_percent <- prop.table(crime_type) * 100
# sort types with frequencies below 3% into "Other"category 
other_crime_types <- names(crime_type_percent)[crime_type_percent < 3]
crime_type["Other"] <- sum(crime_type[other_crime_types])
crime_type <- crime_type[!(names(crime_type) %in% other_crime_types)]
# plot Primary Type pie chart
pie(crime_type, main = "Distribution of Crimes by Type", col = rainbow(length(crime_type)))
```

## Barplot
With this plot we will analyze the location of the crimes

```{r}
# Plot the location of the crimes using a barplot
table = table(crimes_data$`Location Description`)
ordered = table[order(table, decreasing = TRUE)][1:5]

barplot(ordered, main="Location of Crimes", col = "skyblue", 
        xlab="Location", ylab="Frequency", beside = TRUE)

```

## Heatmap/Dotchart

```{r}
# With this plot we will analyze the correlation between domestic & arrest

# Dot chart
domestic_freq <- table(crimes_data$Domestic)
arrest_freq <- table(crimes_data$Arrest)
crimes_data$Domestic <- as.factor(crimes_data$Domestic)
crimes_data$Arrest <- as.factor(crimes_data$Arrest)
par(mfrow = c(1, 2))  
dotchart(domestic_freq, main = "Frequency of Domestic", xlab = "Frequency", cex = 1.5)
dotchart(arrest_freq, main = "Frequency of Arrest", xlab = "Frequency", cex = 1)

# Or heatmap
crimes_data$Arrest <- as.numeric(as.factor(crimes_data$Arrest))
crimes_data$Domestic <- as.numeric(as.factor(crimes_data$Domestic))
# correlation matrix
correlation_matrix <- cor(crimes_data[, c("Domestic", "Arrest")])
print(correlation_matrix)
heatmap(correlation_matrix, 
        Rowv = NA, Colv = NA, 
        col = cm.colors(256), 
        scale = "none",
        margins = c(6, 6),
        cexRow = 1, cexCol = 1)
```
The correlation coefficient between "Domestic" and "Arrest" is -0.06, indicating a weak negative correlation between the likelihood of a crime being domestic and the occurrence of an arrest. In other words, there seems to be little to no relationship between whether a crime is domestic and whether an arrest is made.

## Scatterplot

```{r}
## Scatterplot/leaflet map
# With this plot we will analyze the latitute and longitude (location) of crimes

plot(crimes_data$Longitude, crimes_data$Latitude, 
     xlab = "Longitude", ylab = "Latitude",
     main = "Scatterplot of Crime Locations",
     xlim = c(-87.85, -87.5), ylim = c(41.6, 41.9))
# There are some issues with the scatterplot, so maybe a leaflet map will be better:
install.packages("leaflet")
library(leaflet)
install.packages("leaflet.extras")
library(leaflet.extras)
# leaflet map
map <- leaflet(data = crimes_data) %>%
  addTiles() %>%
  addHeatmap(lng = ~Longitude, lat = ~Latitude, radius = 10) %>%
  setView(lng = -87.675, lat = 41.75, zoom = 12)  # Center and zoom level for the map
map
```

#### Statistical modeling and analysis

```{r}
# We will use a linear regression model to analyze the relationship between the number of crimes and the year
# crimes and age
# crimes and location

